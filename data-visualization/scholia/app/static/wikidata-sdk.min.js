!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.wdk=e()}}(function(){return function e(t,i,n){function r(a,o){if(!i[a]){if(!t[a]){var u="function"==typeof require&&require;if(!o&&u)return u(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[a]={exports:{}};t[a][0].call(c.exports,function(e){var i=t[a][1][e];return r(i?i:e)},c,c.exports,e,t,i,n)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,i){(function(){var i,n;n=e("./wikidata_time_to_date_object"),i={},i.isNumericId=function(e){return/^[0-9]+$/.test(e)},i.isWikidataId=function(e){return/^(Q|P)[0-9]+$/.test(e)},i.isWikidataEntityId=function(e){return/^Q[0-9]+$/.test(e)},i.isWikidataPropertyId=function(e){return/^P[0-9]+$/.test(e)},i.normalizeId=function(e,t,n){if(null==n&&(n="Q"),i.isNumericId(e))return t?e:""+n+e;if(i.isWikidataId(e))return t?e.slice(1):e;throw new Error("invalid id")},i.getNumericId=function(e){if(!i.isWikidataId(e))throw new Error("invalid wikidata id: "+e);return e.replace(/Q|P/,"")},i.normalizeIds=function(e,t,n){return null==n&&(n="Q"),e.map(function(e){return i.normalizeId(e,t,n)})},i.wikidataTimeToDateObject=n,i.wikidataTimeToEpochTime=function(e){return n(e).getTime()},i.wikidataTimeToISOString=function(e){return n(e).toISOString()},i.normalizeWikidataTime=i.wikidataTimeToEpochTime,t.exports=i}).call(this)},{"./wikidata_time_to_date_object":4}],2:[function(e,t,i){(function(){var i;i=e("./simplify_claims"),t.exports={wd:{entities:function(e){var t,n,r;e=e.body||e,t=e.entities;for(r in t)n=t[r],n.claims=i(n.claims);return t}}}}).call(this)},{"./simplify_claims":3}],3:[function(e,t,i){(function(){var i,n,r,s,a,o;n=e("./helpers"),a=function(e){var t,i,n;n={};for(t in e)i=e[t],n[t]=o(i);return n},o=function(e){return e.map(s).filter(r)},r=function(e){return null!=e},s=function(e){var t,r,s;if(s=e.mainsnak,null==s)return null;if(t=s.datatype,r=s.datavalue,null==r)return null;switch(t){case"string":case"commonsMedia":case"url":case"external-id":return r.value;case"monolingualtext":return r.value.text;case"wikibase-item":case"wikibase-property":return r.value.id;case"time":return n.normalizeWikidataTime(r.value.time);case"quantity":return parseFloat(r.value.amount);case"globe-coordinate":return i(r.value);default:return null}},i=function(e){var t,i;return t=e.latitude,i=e.longitude,[t,i]},t.exports={simplifyClaims:a,simplifyPropertyClaims:o,simplifyClaim:s}}).call(this)},{"./helpers":1}],4:[function(e,t,i){(function(){var e,i,n,r;t.exports=function(t){var i,r,s;return s=t[0],r=t.slice(1),i=e(s,r),"Invalid Date"===i.toString()?n(s,r):i},e=function(e,t){return"-"===e?i(t):r(t)},r=function(e){return new Date(e)},i=function(e){var t;return t="-00"+e,new Date(t)},n=function(t,i){var n,r,s,a;return s=i.split("T")[0].split("-"),a=s[0],r=s[1],n=s[2],e(t,a)}}).call(this)},{}],5:[function(e,t,i){(function(){var i,n,r,s,a,o;r=e("../helpers/helpers"),i=e("../utils/build_url"),a=e("../utils/utils"),s=a.isPlainObject,n=a.forceArray,o=a.shortLang,t.exports=function(e,t,a,u){var l,c;if(s(e)&&(c=e,e=c.ids,t=c.languages,a=c.props,u=c.format),u||(u="json"),null==e&&0!==e.length)throw new Error("no id provided");return e.length>50&&console.warn("getEntities accepts 50 ids max to match Wikidata API limitations:\nthis request won't get all the desired entities.\nYou can use getManyEntities instead to generate several request urls\nto work around this limitation"),e=r.normalizeIds(n(e)),a=n(a),l={action:"wbgetentities",ids:e.join("|"),format:u},null!=t&&(t=n(t).map(o),l.languages=t.join("|")),(null!=a?a.length:void 0)>0&&(l.props=a.join("|")),i("wikidata",l)}}).call(this)},{"../helpers/helpers":1,"../utils/build_url":12,"../utils/utils":14}],6:[function(e,t,i){(function(){var i,n,r;i=e("./get_entities"),r=e("../utils/utils").isPlainObject,t.exports=function(e,t,s,a){var o;if(r(e)&&(o=e,e=o.ids,t=o.languages,s=o.props,a=o.format),!(e instanceof Array))throw new Error("getManyEntities expects an array of ids");return n(e).map(function(e){return i(e,t,s,a)})},n=function(e){var t,i;for(i=[];e.length>0;)t=e.slice(0,50),e=e.slice(50),i.push(t);return i}}).call(this)},{"../utils/utils":14,"./get_entities":5}],7:[function(e,t,i){(function(){var i,n;i=e("../helpers/helpers"),n=e("./sparql_query"),t.exports=function(e,t,r){var s;return null==r&&(r=1e3),i.isWikidataEntityId(t)?t="wd:"+t:"string"==typeof t&&(t='"'+t+'"'),s="SELECT ?subject WHERE {\n  ?subject wdt:"+e+" "+t+" .\n}\nLIMIT "+r,n(s)}}).call(this)},{"../helpers/helpers":1,"./sparql_query":11}],8:[function(e,t,i){(function(){var i,n,r,s,a,o;i=e("../utils/build_url"),a=e("../utils/utils"),r=a.isPlainObject,n=a.forceArray,o=a.shortLang,t.exports=function(e,t,a,u,l){var c,f;if(r(e)&&(f=e,e=f.titles,t=f.sites,a=f.languages,u=f.props,l=f.format),l||(l="json"),null==e||0===e.length)throw new Error("no title provided");return null!=t&&0!==t.length||(t=["enwiki"]),e=n(e),t=n(t).map(s),u=n(u),c={action:"wbgetentities",titles:e.join("|"),sites:t.join("|"),format:l},null!=a&&(a=n(a).map(o),c.languages=a.join("|")),(null!=u?u.length:void 0)>0&&(c.props=u.join("|")),i("wikidata",c)},s=function(e){return 2===e.length?e+"wiki":e}}).call(this)},{"../utils/build_url":12,"../utils/utils":14}],9:[function(e,t,i){(function(){var i,n;i=e("../utils/build_url"),n=e("../utils/utils").isPlainObject,t.exports=function(e,t,r,s,a){var o;if(n(e)&&(o=e,e=o.search,t=o.language,r=o.limit,s=o.format,a=o.uselang),!((null!=e?e.length:void 0)>0))throw new Error("search can't be empty");return t||(t="en"),a||(a=t),r||(r="20"),s||(s="json"),i("wikidata",{action:"wbsearchentities",search:e,language:t,limit:r,format:s,uselang:a})}}).call(this)},{"../utils/build_url":12,"../utils/utils":14}],10:[function(e,t,i){(function(){var e,i,n,r,s=[].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1};t.exports=function(t){var i,n,s,a,o,u;return"string"==typeof t&&(t=JSON.parse(t)),a=t.head.vars,n=t.results.bindings,1===a.length?(s=a[0],n.map(function(e){return r(e[s])}).filter(function(e){return null!=e})):(i=e(a),o=i[0],u=i[1],n.map(function(e){var t,i,n,a,l;for(l={},t=0,n=o.length;t<n;t++)s=o[t],l[s]={value:r(e[s]),label:e[s+"Label"].value};for(i=0,a=u.length;i<a;i++)s=u[i],l[s]=r(e[s]);return l}))},r=function(e){var t;if(null!=e)switch(e.type){case"uri":return n(e.value);case"bnode":return null;default:switch(null!=(t=e.datatype)?t.replace("http://www.w3.org/2001/XMLSchema#",""):void 0){case"decimal":case"integer":case"float":case"double":return parseFloat(e.value);case"boolean":return"true"===e.value;default:return e.value}}},n=function(e){return e.replace("http://www.wikidata.org/entity/","")},i=function(e){return/^\w+Label$/.test(e)},e=function(e){var t,i,n,r,a,o;for(a=[],o=[],t=0,i=e.length;t<i;t++)r=e[t],n=r+"Label",s.call(e,n)>=0?a.push(r):/^\w+Label$/.test(r)||o.push(r);return[a,o]}}).call(this)},{}],11:[function(e,t,i){(function(){t.exports=function(e){var t;return t=encodeURIComponent(e),"https://query.wikidata.org/sparql?format=json&query="+t}}).call(this)},{}],12:[function(e,t,i){(function(){var i,n,r;try{n=e("querystring")}catch(t){i=t,n=e("./querystring_lite")}r={wikidata:"https://www.wikidata.org/w/api.php",commons:"http://commons.wikimedia.org"},t.exports=function(e,t){return r[e]+"?"+n.stringify(t)}}).call(this)},{"./querystring_lite":13,querystring:18}],13:[function(e,t,i){(function(){t.exports={stringify:function(e){var t,i,n;i="";for(t in e)n=e[t],null!=n&&(i+="&"+t+"="+n);return i=i.slice(1),"undefined"!=typeof encodeURI&&null!==encodeURI?encodeURI(i):i}}}).call(this)},{}],14:[function(e,t,i){(function(){t.exports={shortLang:function(e){return e.slice(0,3)},forceArray:function(e){return"string"==typeof e&&(e=[e]),e||[]},isPlainObject:function(e){return null!=e&&("object"==typeof e&&!(e instanceof Array))}}}).call(this)},{}],15:[function(e,t,i){(function(){var i,n,r,s,a,o,u,l;t.exports=l={},i=e("./helpers/helpers"),l.searchEntities=e("./queries/search_entities"),l.getEntities=e("./queries/get_entities"),l.getManyEntities=e("./queries/get_many_entities"),l.getWikidataIdsFromSitelinks=e("./queries/get_wikidata_ids_from_sitelinks"),l.sparqlQuery=e("./queries/sparql_query"),l.getReverseClaims=e("./queries/get_reverse_claims"),l.parse=e("./helpers/parse_responses"),r=e("./helpers/simplify_claims"),s=r.simplifyClaim,o=r.simplifyPropertyClaims,a=r.simplifyClaims,l.simplifyClaim=s,l.simplifyPropertyClaims=o,l.simplifyClaims=a,l.simplifySparqlResults=e("./queries/simplify_sparql_results"),l.getWikidataIdsFromWikipediaTitles=l.getWikidataIdsFromSitelinks,l.helpers=i;for(n in i)u=i[n],l[n]=u}).call(this)},{"./helpers/helpers":1,"./helpers/parse_responses":2,"./helpers/simplify_claims":3,"./queries/get_entities":5,"./queries/get_many_entities":6,"./queries/get_reverse_claims":7,"./queries/get_wikidata_ids_from_sitelinks":8,"./queries/search_entities":9,"./queries/simplify_sparql_results":10,"./queries/sparql_query":11}],16:[function(e,t,i){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,i,s){t=t||"&",i=i||"=";var a={};if("string"!=typeof e||0===e.length)return a;var o=/\+/g;e=e.split(t);var u=1e3;s&&"number"==typeof s.maxKeys&&(u=s.maxKeys);var l=e.length;u>0&&l>u&&(l=u);for(var c=0;c<l;++c){var f,p,d,m,h=e[c].replace(o,"%20"),g=h.indexOf(i);g>=0?(f=h.substr(0,g),p=h.substr(g+1)):(f=h,p=""),d=decodeURIComponent(f),m=decodeURIComponent(p),n(a,d)?r(a[d])?a[d].push(m):a[d]=[a[d],m]:a[d]=m}return a};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],17:[function(e,t,i){"use strict";function n(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,i,o){return t=t||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?n(a(e),function(a){var o=encodeURIComponent(r(a))+i;return s(e[a])?n(e[a],function(e){return o+encodeURIComponent(r(e))}).join(t):o+encodeURIComponent(r(e[a]))}).join(t):o?encodeURIComponent(r(o))+i+encodeURIComponent(r(e)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},{}],18:[function(e,t,i){"use strict";i.decode=i.parse=e("./decode"),i.encode=i.stringify=e("./encode")},{"./decode":16,"./encode":17}]},{},[15])(15)});
